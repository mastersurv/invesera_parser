# Тесты проекта InvestEra

Полный набор тестов для проверки функциональности парсера статей Википедии.

## Структура тестов

### `test_api.py` - Тесты API эндпоинтов
- Проверка health check эндпоинтов
- Тестирование парсинга статей
- Валидация ответов API
- Обработка ошибок

### `test_services.py` - Тесты сервисного слоя
- Тестирование ArticleService
- Проверка логики парсинга
- Тестирование генерации summary
- Обработка исключений

### `test_repositories.py` - Тесты репозиториев
- CRUD операции с базой данных
- Проверка relationships между статьями
- Тестирование запросов к БД

### `test_parsers.py` - Тесты парсеров
- Тестирование WikipediaParser
- Проверка извлечения контента
- Валидация URL
- Обработка HTTP ошибок

### `test_ai.py` - Тесты AI компонентов
- Тестирование SummaryGenerator
- Проверка интеграции с OpenAI API
- Обработка ошибок API
- Тестирование промптов

## Запуск тестов

### Все тесты
```bash
pytest
```

### Конкретный файл
```bash
pytest tests/test_api.py
```

### Конкретный тест
```bash
pytest tests/test_api.py::TestHealthEndpoints::test_root_endpoint
```

### С покрытием кода
```bash
pytest --cov=app tests/
```

## Особенности

- Используется in-memory SQLite для тестов БД
- Моки для внешних API (OpenAI, Wikipedia)
- Асинхронные тесты с pytest-asyncio
- Изоляция тестов через фикстуры

## Конфигурация

Настройки тестов в `pytest.ini`:
- Автоматический режим asyncio
- Подавление предупреждений
- Краткий вывод ошибок 